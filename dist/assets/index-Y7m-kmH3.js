var be=(e,o)=>()=>(o||e((o={exports:{}}).exports,o),o.exports);var lt=be((rt,V)=>{(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const d of r.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function i(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(s){if(s.ep)return;s.ep=!0;const r=i(s);fetch(s.href,r)}})();const n=document.getElementById("gameCanvas");n.width=960;n.height=600;const t=n.getContext("2d");let h={name:"",avatar:null,email:"",subscription:!1,maxLevel:1};function se(){const e=localStorage.getItem("dinoWarfareCurrentUser");e&&(h=JSON.parse(e))}function Ee(e){return e<=3||h.subscription?!0:window.checkSubscriptionStatus?window.checkSubscriptionStatus(e):!1}const re=new Image;re.src="assets/sprites/sprites_player.png";const ce=new Image;ce.src="assets/sprites/sprites_raptor.png";const de=new Image;de.src="assets/sprites/sprites_trex.png";const B=new Image;B.src="assets/sprites/sprites_motherdino.png";const Pe=new Image;Pe.src="assets/sprites/sprites_bullet.png";const Ae=new Image;Ae.src="assets/sprites/sprites_powerup.png";const he=new Image;he.src="assets/sprites/sprites_velociraptor.png";const ue=new Image;ue.src="assets/sprites/sprites_triceratops.png";const fe=new Image;fe.src="assets/sprites/sprites_stegosaurus.png";const pe=new Image;pe.src="assets/sprites/sprites_pterodactyl.png";const ge=new Image;ge.src="assets/sprites/sprites_spinosaurus.png";const me=new Image;me.src="assets/sprites/sprites_ankylosaurus.png";const we=new Image;we.src="assets/sprites/sprites_pachycephalosaurus.png";const Z=new Image,H=new Audio("./assets/sounds/sounds_shoot.wav"),$=new Audio("./assets/sounds/sounds_hit.wav"),X=new Audio("./assets/sounds/sounds_gameover.wav"),J=new Audio("./assets/sounds/sounds_regen.wav"),z=new Audio("./assets/sounds/sounds_shield.wav"),f=new Audio("./assets/sounds/sounds_background.wav"),K=new Audio("./assets/sounds/sounds_boss_intro.mp3");H.addEventListener("error",()=>console.warn("Failed to load shoot sound"));$.addEventListener("error",()=>console.warn("Failed to load hit sound"));X.addEventListener("error",()=>console.warn("Failed to load game over sound"));J.addEventListener("error",()=>console.warn("Failed to load regen sound"));z.addEventListener("error",()=>console.warn("Failed to load shield sound"));f.addEventListener("error",()=>console.warn("Failed to load background music"));K.addEventListener("error",()=>console.warn("Failed to load boss intro sound"));f.loop=!0;let v=!1,P=!1,p=!1,x=!1,A=0,I=4,S=0,u=1,c=1,ee=0,te=0,_=!1,q=0;const ie=["Love","Joy","Peace","Patience","Kindness","Goodness","Faithfulness","Gentleness","Self-Control","Faith","Hope"];function ne(e){const o=(e-1)%ie.length;return ie[o]}function U(e){const o=ne(e),i=Math.floor((e-1)/ie.length)+1;return i>1?`${o} (Cycle ${i})`:o}let l={x:n.width/2,y:n.height-100,radius:30,speed:8,shield:!1,bulletCooldown:0,bulletSpeed:12,maxBullets:3,bulletSize:4,diagonalShooting:!1},T=[],w=[],E=[],L=[],D=[],b={};const Te=[{img:ce,speed:2,health:1,points:10,radius:25,level:1,name:"Raptor"},{img:de,speed:1.5,health:2,points:20,radius:30,level:1,name:"T-Rex"},{img:he,speed:3,health:1,points:15,radius:20,level:2,name:"Velociraptor"},{img:ue,speed:1,health:3,points:25,radius:35,level:2,name:"Triceratops"},{img:fe,speed:.8,health:4,points:30,radius:40,level:3,name:"Stegosaurus"},{img:pe,speed:4,health:1,points:20,radius:25,level:3,name:"Pterodactyl"},{img:ge,speed:1.2,health:5,points:40,radius:45,level:4,name:"Spinosaurus"},{img:me,speed:.6,health:6,points:35,radius:35,level:4,name:"Ankylosaurus"},{img:we,speed:2.5,health:3,points:30,radius:30,level:5,name:"Pachycephalosaurus"}],j=[{img:B,health:50,speed:1.2,fireRate:60,name:"Mother Dino",level:1,scale:1},{img:B,health:75,speed:1.5,fireRate:45,name:"Mother Dino Elite",level:2,scale:1.2},{img:B,health:100,speed:1.8,fireRate:40,name:"Mother Dino Alpha",level:3,scale:1.4},{img:B,health:150,speed:1,fireRate:30,name:"Mother Dino Supreme",level:4,scale:1.6},{img:B,health:200,speed:1.3,fireRate:25,name:"Mother Dino Legend",level:5,scale:1.8}],Me=[{type:"regen",color:"green",points:0},{type:"shield",color:"blue",points:0}];let y=[];const ae=[{name:"Extra Life",cost:50,effect:"lives",value:1},{name:"Faster Bullets",cost:30,effect:"bulletSpeed",value:2},{name:"More Bullets",cost:40,effect:"maxBullets",value:1},{name:"Bigger Bullets",cost:25,effect:"bulletSize",value:1},{name:"Faster Movement",cost:35,effect:"speed",value:1},{name:"Extra Diagonal Bullets",cost:60,effect:"diagonalShooting",value:!0}];window.addEventListener("keydown",e=>b[e.key]=!0);window.addEventListener("keyup",e=>b[e.key]=!1);n.addEventListener("mousemove",e=>{if(x){const o=n.getBoundingClientRect(),i=n.width/o.width,a=n.height/o.height,s=(e.clientX-o.left)*i,r=(e.clientY-o.top)*a,d=160,k=60;ae.forEach((g,M)=>{const Q=d+M*k;if(S>=g.cost){const C=n.width/2+50,R=Q-5;s>=C&&s<=C+80&&r>=R&&r<=R+40?window.hoveredButton={index:M,item:g}:window.hoveredButton=null}})}});n.addEventListener("click",e=>{if(!v||P){startGame();return}if(x){const o=n.getBoundingClientRect(),i=n.width/o.width,a=n.height/o.height,s=(e.clientX-o.left)*i,r=(e.clientY-o.top)*a;console.log("Shop click detected at:",s,r,"Canvas size:",n.width,"x",n.height,"Rect size:",o.width,"x",o.height);const d=160,k=60;ae.forEach((g,M)=>{const Q=d+M*k,N=S>=g.cost,C=n.width/2+50,R=Q-5,Y=80,G=40;if(console.log(`Item ${M} (${g.name}): Button at ${C},${R} size ${Y}x${G}, canAfford: ${N}`),N&&s>=C&&s<=C+Y&&r>=R&&r<=R+G){console.log("✅ Buying:",g.name,"for",g.cost,"coins"),Ce(g);return}else if(!N&&s>=C&&s<=C+Y&&r>=R&&r<=R+G){console.log("❌ Not enough coins for:",g.name),oe(`❌ Not enough coins for ${g.name}`);return}})}if(p&&!x){const o=n.getBoundingClientRect(),i=n.width/o.width,a=n.height/o.height,s=(e.clientX-o.left)*i,r=(e.clientY-o.top)*a;console.log("Pause screen click at:",s,r);const d=n.height/2+80,k=200,g=50,M=n.width/2-k/2;console.log("Share button area:",M,d,k,g),s>=M&&s<=M+k&&r>=d&&r<=d+g&&(console.log("Share button clicked!"),Se())}});document.getElementById("pauseBtn").onclick=()=>{v&&!P&&(p=!p,p?f.pause():f.play().catch(()=>{}))};document.getElementById("resumeBtn").onclick=()=>{!P&&v&&(p=!1,x=!1,f.play().catch(()=>{}))};document.getElementById("stopBtn").onclick=()=>{v&&(p=!0,x=!1,f.pause())};document.getElementById("shopBtn").onclick=()=>{v&&!P&&(x=!x,x?(p=!0,f.pause()):(p=!1,f.play().catch(()=>{})))};const ye={PREMIUM_POWER_UPS:[{type:"laser",color:"red",points:0,duration:1e4,effect:"continuous laser beam"},{type:"shield_plus",color:"cyan",points:0,duration:15e3,effect:"invincible shield"},{type:"time_slow",color:"purple",points:0,duration:8e3,effect:"slow motion enemies"},{type:"nuke",color:"orange",points:0,duration:0,effect:"destroy all enemies"},{type:"multi_shot",color:"yellow",points:0,duration:12e3,effect:"5-way bullet spread"}],PARTICLE_SYSTEMS:{explosion:{count:20,speed:3,life:60,color:"orange"},laser:{count:5,speed:2,life:30,color:"red"},shield:{count:8,speed:1,life:90,color:"cyan"},powerup:{count:15,speed:2,life:45,color:"gold"}}};let F=[];function O(e,o,i){if(!h.subscription&&c<=3)return;const a=ye.PARTICLE_SYSTEMS[i];if(a)for(let s=0;s<a.count;s++)F.push({x:e,y:o,vx:(Math.random()-.5)*a.speed,vy:(Math.random()-.5)*a.speed,life:a.life,maxLife:a.life,color:a.color,size:Math.random()*3+1})}function Ie(){F.forEach((e,o)=>{e.x+=e.vx,e.y+=e.vy,e.life--,e.life<=0&&F.splice(o,1)})}function ke(){F.forEach(e=>{const o=e.life/e.maxLife;t.save(),t.globalAlpha=o,t.fillStyle=e.color,t.beginPath(),t.arc(e.x,e.y,e.size,0,Math.PI*2),t.fill(),t.restore()})}window.testShare=function(){console.log("Testing share functionality..."),Se()};window.startGameFromAuth=function(){se(),h.avatar&&(Z.src=h.avatar),v=!0,p=!1,P=!1,x=!1,A=0,I=4,S=0,u=1,c=1,_=!1,q=0,ee=0,te=0,T=[],w=[],E=[],L=[],D=[],F=[],l.x=n.width/2,l.y=n.height-100,l.shield=!1,l.bulletCooldown=0,l.speed=8,l.bulletSpeed=12,l.maxBullets=3,l.bulletSize=4,l.diagonalShooting=!1,h.subscription&&(l.speed+=2,l.bulletSpeed+=3,l.maxBullets+=1),window.purchaseMessages=[],window.levelMessages=[],window.lastWaveTime=Date.now(),window.lastLevelWave=0,window.lastRapidFireWave=0,window.lastBossRushWave=0,f.play().catch(()=>{}),console.log("Game started from authentication system"),console.log("Player data:",h)};window.testSounds=function(){console.log("Testing sounds..."),H.play().catch(e=>console.warn("Shoot sound failed:",e)),setTimeout(()=>$.play().catch(e=>console.warn("Hit sound failed:",e)),500),setTimeout(()=>J.play().catch(e=>console.warn("Regen sound failed:",e)),1e3),setTimeout(()=>z.play().catch(e=>console.warn("Shield sound failed:",e)),1500),console.log("Sound test completed")};v||(console.log("No authentication detected, starting with default settings"),se());function Ce(e){if(S>=e.cost){switch(S-=e.cost,e.effect){case"lives":I+=e.value;break;case"bulletSpeed":l.bulletSpeed+=e.value;break;case"maxBullets":l.maxBullets+=e.value;break;case"bulletSize":l.bulletSize+=e.value;break;case"speed":l.speed+=e.value;break;case"diagonalShooting":l.diagonalShooting=e.value;break}$.play().catch(()=>{}),oe(e.name)}else oe(`❌ Not enough coins for ${e.name}`)}function oe(e){const o={text:`✅ Purchased: ${e}`,x:n.width/2,y:n.height/2,alpha:1,life:120};window.purchaseMessages||(window.purchaseMessages=[]),window.purchaseMessages.push(o)}function Re(){l.x<l.radius&&(l.x=l.radius),l.x>n.width-l.radius&&(l.x=n.width-l.radius)}function _e(){if(l.bulletCooldown<=0){if(H.play().catch(()=>{}),y.find(i=>i.type==="multi_shot"))[-45,-30,-15,0,15,30,45,90].forEach(a=>{const s=a*Math.PI/180;T.push({x:l.x,y:l.y-20,radius:l.bulletSize,speed:l.bulletSpeed,vx:Math.sin(s)*l.bulletSpeed,vy:-Math.cos(s)*l.bulletSpeed,diagonal:!0})});else{for(let i=0;i<l.maxBullets;i++){const a=(i-(l.maxBullets-1)/2)*8;T.push({x:l.x+a,y:l.y-20,radius:l.bulletSize,speed:l.bulletSpeed,vx:0,vy:-l.bulletSpeed,diagonal:!1})}l.diagonalShooting&&[45,135,225,315].forEach(a=>{const s=a*Math.PI/180;T.push({x:l.x,y:l.y-20,radius:l.bulletSize,speed:l.bulletSpeed,vx:Math.sin(s)*l.bulletSpeed,vy:-Math.cos(s)*l.bulletSpeed,diagonal:!0})})}y.find(i=>i.type==="laser")&&O(l.x,l.y-20,"laser"),l.bulletCooldown=15}}function Le(){b.ArrowLeft&&(l.x-=l.speed),b.ArrowRight&&(l.x+=l.speed),b[" "]&&_e(),(b.p||b.P)&&v&&!P&&(p=!p,p?f.pause():f.play().catch(()=>{})),(b.s||b.S)&&v&&!P&&(x=!x,x?(p=!0,f.pause()):(p=!1,f.play().catch(()=>{}))),(b.d||b.D)&&v&&(window.debugMode=!window.debugMode),Re(),l.bulletCooldown>0&&l.bulletCooldown--}function Be(){T.forEach((e,o)=>{e.vx!==void 0&&e.vy!==void 0?(e.x+=e.vx,e.y+=e.vy):e.y-=e.speed,(e.y<-10||e.x<-10||e.x>n.width+10)&&T.splice(o,1)})}function $e(){const o=y.find(i=>i.type==="time_slow")?.3:1;w.forEach((i,a)=>{i.y+=i.speed*o,i.y>n.height+50&&w.splice(a,1)})}function De(){E.forEach((e,o)=>{e.x+=e.speed*e.direction,(e.x<=0||e.x+e.width>=n.width)&&(e.direction*=-1),e.fireCooldown<=0?(L.push({x:e.x+e.width/2,y:e.y+e.height,radius:8,speed:4}),e.fireCooldown=e.fireRate):e.fireCooldown--})}function We(){L.forEach((e,o)=>{e.y+=e.speed,e.y>n.height+20&&L.splice(o,1)})}function ze(){D.forEach((e,o)=>{e.y+=2,e.y>n.height+20&&D.splice(o,1)})}function Oe(){return Te.filter(e=>e.level<=c)}function Fe(){const e=Date.now(),o=Math.max(2e3-u*100-c*50,800);if(e-ee>o){const i=Math.min(3+Math.floor(u/3)+Math.floor(c/2),8);if(w.length<i){const a=Oe();if(a.length>0){const s=a[Math.floor(Math.random()*a.length)];w.push({x:Math.random()*(n.width-60)+30,y:-50,...s,currentHealth:s.health})}}ee=e}}function He(){if(u%5===0&&E.length===0){const e=j.find(r=>r.level<=c)||j[0],o=e.health+c*10,i=e.scale||1,a=120*i,s=120*i;E.push({x:n.width/2-a/2,y:30,width:a,height:s,health:o,maxHealth:o,speed:e.speed,direction:1,fireCooldown:0,fireRate:e.fireRate,img:e.img,name:e.name}),e.name.includes("Mother Dino")?m(`🦖 BOSS WAVE: ${e.name} appears! 🦖`):m(`BOSS WAVE: ${e.name} appears!`),K.play().catch(()=>{})}if(u%15===0&&u>5&&E.length===0){const a={x:n.width/2-120,y:30,width:240,height:240,health:300+c*20,maxHealth:300+c*20,speed:.8,direction:1,fireCooldown:0,fireRate:20,img:B,name:"Mother Dino Ultimate"};E.push(a),m("🦖 SPECIAL EVENT: Mother Dino Ultimate! 🦖"),K.play().catch(()=>{})}}function Ue(){const e=Date.now();if(e-te>1e4){if(Math.random()<.3){let o=[...Me];(h.subscription||c>=3)&&(o=o.concat(ye.PREMIUM_POWER_UPS));const i=o[Math.floor(Math.random()*o.length)],a={x:Math.random()*(n.width-30)+15,y:-20,...i,radius:15,pulse:0};D.push(a),i.type!=="regen"&&i.type!=="shield"&&O(a.x,a.y,"powerup")}te=e}}function Ne(){if(!_){if(u%10===0&&u>0&&u!==window.lastLevelWave){window.lastLevelWave=u;const e=c+1;if(!Ee(e)){m("🔒 Subscribe to continue to Level "+e);return}if(_=!0,q=90,c++,c>50&&(c=50),h.email){const a=JSON.parse(localStorage.getItem("dinoWarfareUsers")||"{}");a[h.email]&&(a[h.email].maxLevel=Math.max(a[h.email].maxLevel,c),localStorage.setItem("dinoWarfareUsers",JSON.stringify(a)))}w=[],E=[],L=[];const o=c*25;S+=o;const i=U(c);m(`LEVEL ${c}: ${i} COMPLETE! +${o} coins`),c===4&&m("🎉 Free trial completed! Subscribe for unlimited access!")}_||(u%7===0&&u>1&&u!==window.lastRapidFireWave&&(window.lastRapidFireWave=u,m("RAPID FIRE WAVE - Enemies spawn faster!")),u%9===0&&u>1&&u!==window.lastBossRushWave&&(window.lastBossRushWave=u,m("BOSS RUSH - Multiple bosses may appear!")))}}function m(e){window.levelMessages||(window.levelMessages=[]),window.levelMessages.length<3&&window.levelMessages.push({text:e,x:n.width/2,y:n.height/2,alpha:1,life:120})}function Ye(){T.forEach((e,o)=>{w.forEach((i,a)=>{const s=e.x-i.x,r=e.y-i.y;Math.sqrt(s*s+r*r)<e.radius+i.radius&&(i.currentHealth--,i.currentHealth<=0&&(A+=i.points,S+=Math.floor(i.points/10),$.play().catch(()=>{}),w.splice(a,1)),T.splice(o,1))}),E.forEach((i,a)=>{const s=e.x-(i.x+i.width/2),r=e.y-(i.y+i.height/2);Math.sqrt(s*s+r*r)<e.radius+Math.max(i.width,i.height)/2&&(i.health--,T.splice(o,1),i.health<=0&&(A+=100,S+=10,$.play().catch(()=>{}),E.splice(a,1)))})}),w.forEach((e,o)=>{const i=l.x-e.x,a=l.y-e.y;Math.sqrt(i*i+a*a)<l.radius+e.radius&&(y.find(d=>d.type==="shield_plus")?(O(e.x,e.y,"explosion"),A+=e.points,S+=Math.floor(e.points/10),w.splice(o,1)):l.shield?(l.shield=!1,z.play().catch(()=>{}),w.splice(o,1)):(I--,I<=0&&(P=!0,X.play().catch(()=>{}),f.pause()),w.splice(o,1)))}),L.forEach((e,o)=>{const i=e.x-l.x,a=e.y-l.y;Math.sqrt(i*i+a*a)<e.radius+l.radius&&(l.shield?(l.shield=!1,z.play().catch(()=>{})):(I--,I<=0&&(P=!0,X.play().catch(()=>{}),f.pause())),L.splice(o,1))}),D.forEach((e,o)=>{const i=l.x-e.x,a=l.y-e.y;if(Math.sqrt(i*i+a*a)<l.radius+e.radius){switch(O(e.x,e.y,"powerup"),e.type){case"regen":I++,J.play().catch(()=>{}),m("💚 Health Restored!");break;case"shield":l.shield=!0,z.play().catch(()=>{}),m("🛡️ Shield Activated!");break;case"laser":Ge(),m("🔴 LASER MODE ACTIVATED!");break;case"shield_plus":Ve(),m("💎 INVINCIBLE SHIELD!");break;case"time_slow":Xe(),m("⏰ TIME SLOW ACTIVATED!");break;case"nuke":Ke(),m("💥 NUKE DETONATED!");break;case"multi_shot":qe(),m("🎯 MULTI-SHOT MODE!");break}D.splice(o,1)}})}function Ge(){y.find(e=>e.type==="laser")||y.push({type:"laser",duration:1e4,startTime:Date.now()})}function Ve(){y.find(e=>e.type==="shield_plus")||y.push({type:"shield_plus",duration:15e3,startTime:Date.now()})}function Xe(){y.find(e=>e.type==="time_slow")||y.push({type:"time_slow",duration:8e3,startTime:Date.now()})}function Ke(){w.forEach(e=>{O(e.x,e.y,"explosion"),A+=e.points,S+=Math.floor(e.points/10)}),w=[],E.forEach(e=>{e.health=Math.max(0,e.health-50),O(e.x+e.width/2,e.y+e.height/2,"explosion")})}function qe(){y.find(e=>e.type==="multi_shot")||y.push({type:"multi_shot",duration:12e3,startTime:Date.now()})}function je(){const e=Date.now();y=y.filter(o=>e-o.startTime<o.duration)}function Je(){if(p||!v||P)return;_&&(q--,q<=0&&(_=!1)),Le(),Be(),$e(),De(),We(),ze(),Ie(),je(),_||(Fe(),He(),Ue(),Ye()),window.purchaseMessages&&window.purchaseMessages.forEach((o,i)=>{o.life--,o.alpha=o.life/120,o.y-=.5,o.life<=0&&window.purchaseMessages.splice(i,1)}),window.levelMessages&&window.levelMessages.forEach((o,i)=>{o.life--,o.alpha=o.life/120,o.y-=.3,o.life<=0&&window.levelMessages.splice(i,1)}),window.lastWaveTime||(window.lastWaveTime=Date.now());const e=Date.now();e-window.lastWaveTime>=3e4&&!_&&(u++,window.lastWaveTime=e),Ne()}function Qe(){t.fillStyle="#000000",t.fillRect(0,0,n.width,n.height);const e=70;if(!v){Ze();return}if(P){et();return}h.avatar&&Z.complete?t.drawImage(Z,l.x-30,l.y-30,60,60):t.drawImage(re,l.x-30,l.y-30,60,60),l.shield&&(t.beginPath(),t.arc(l.x,l.y,l.radius+10,0,Math.PI*2),t.strokeStyle="cyan",t.lineWidth=3,t.stroke()),T.forEach(i=>{t.beginPath(),t.arc(i.x,i.y,i.radius,0,Math.PI*2),t.fillStyle="yellow",t.fill()}),w.forEach(i=>{t.drawImage(i.img,i.x-i.radius,i.y-i.radius,i.radius*2,i.radius*2)}),E.forEach(i=>{const s=(j.find(g=>g.name===i.name)||j[0]).scale||1,r=120*s,d=120*s;t.drawImage(i.img,i.x,i.y,r,d),i.name.includes("Mother Dino")?(t.fillStyle="purple",t.font="bold 18px Arial",t.fillText(`🦖 ${i.name} 🦖`,i.x,i.y-10),t.fillStyle="red",t.fillRect(i.x,i.y-15,r,12),t.fillStyle="purple",t.fillRect(i.x,i.y-15,r*(i.health/i.maxHealth),12),t.fillStyle="white",t.font="16px Arial",t.fillText(`${i.health}/${i.maxHealth}`,i.x+r/2-20,i.y+10)):(t.fillStyle="red",t.font="16px Arial",t.fillText(`BOSS: ${i.name}`,i.x,i.y-10),t.fillRect(i.x,i.y-15,r,10),t.fillStyle="green",t.fillRect(i.x,i.y-15,r*(i.health/i.maxHealth),10),t.fillStyle="white",t.fillText(`${i.health}/${i.maxHealth}`,i.x+r/2-20,i.y+10))}),L.forEach(i=>{t.beginPath(),t.arc(i.x,i.y,i.radius,0,Math.PI*2),t.fillStyle="orange",t.fill()}),D.forEach(i=>{if(i.type!=="regen"&&i.type!=="shield"){i.pulse+=.2;const a=Math.sin(i.pulse)*3;t.beginPath(),t.arc(i.x,i.y,i.radius+a,0,Math.PI*2),t.fillStyle=i.color,t.fill(),t.shadowColor=i.color,t.shadowBlur=10,t.beginPath(),t.arc(i.x,i.y,i.radius,0,Math.PI*2),t.fillStyle=i.color,t.fill(),t.shadowBlur=0}else t.beginPath(),t.arc(i.x,i.y,i.radius,0,Math.PI*2),t.fillStyle=i.color,t.fill()}),ke(),y.forEach(i=>{const s=(i.duration-(Date.now()-i.startTime))/i.duration;switch(i.type){case"laser":t.save(),t.globalAlpha=s*.3,t.fillStyle="red",t.fillRect(0,l.y-20,n.width,40),t.restore();break;case"shield_plus":t.save(),t.globalAlpha=s*.5,t.beginPath(),t.arc(l.x,l.y,l.radius+20,0,Math.PI*2),t.strokeStyle="cyan",t.lineWidth=5,t.stroke(),t.restore();break;case"time_slow":t.save(),t.globalAlpha=s*.2,t.fillStyle="purple",t.fillRect(0,0,n.width,n.height),t.restore();break;case"multi_shot":t.save(),t.globalAlpha=s,t.fillStyle="yellow",t.font="16px Arial",t.fillText("🎯 MULTI-SHOT ACTIVE",20,n.height-20),t.restore();break}}),t.fillStyle="white",t.font="18px Arial",t.fillText(`Score: ${A}  Lives: ${I}  Coins: ${S}  Wave: ${u}`,20,30+e),h.name&&(t.fillStyle="#4CAF50",t.font="16px Arial",t.fillText(`Player: ${h.name}`,20,55+e));const o=U(c);t.fillStyle="gold",t.font="16px Arial",t.fillText(`Level ${c}: ${o}`,20,h.name?80+e:50+e),h.subscription?(t.fillStyle="#4CAF50",t.font="14px Arial",t.fillText("✅ Premium Subscriber",20,h.name?105+e:75+e)):c<=3&&(t.fillStyle="#7c5cff",t.font="14px Arial",t.fillText("🎮 Free Trial (Levels 1-3)",20,h.name?105+e:75+e)),x?tt():p&&it(),window.purchaseMessages&&window.purchaseMessages.forEach(i=>{t.save(),t.globalAlpha=i.alpha,t.fillStyle="white",t.font="20px Arial",t.textAlign="center",t.fillText(i.text,i.x,i.y),t.textAlign="left",t.restore()})}function Ze(){t.fillStyle="white",t.font="40px Arial",t.fillText("🦖 DINO WARFARE",n.width/2-180,n.height/2-120),t.font="20px Arial",t.fillText("Fruit of the Spirit Edition",n.width/2-120,n.height/2-80),t.fillStyle="#4CAF50",t.font="16px Arial",t.fillText("Created by David Oshoba George",n.width/2-120,n.height/2-50),h.name&&(t.fillStyle="gold",t.font="18px Arial",t.fillText(`Welcome back, ${h.name}!`,n.width/2-100,n.height/2-20)),t.fillStyle="white",t.font="24px Arial",t.fillText("Click to Start",n.width/2-80,n.height/2+10),t.font="16px Arial",t.fillText("Controls:",n.width/2-100,n.height/2+50),t.fillText("Arrow Keys - Move",n.width/2-100,n.height/2+70),t.fillText("Spacebar - Shoot",n.width/2-100,n.height/2+90),t.fillText("P - Pause/Resume",n.width/2-100,n.height/2+110),t.fillText("S - Open/Close Shop",n.width/2-100,n.height/2+130),t.fillText("D - Debug Mode",n.width/2-100,n.height/2+150),t.font="14px Arial",t.fillStyle="gold",t.fillText("Level Themes: Love, Joy, Peace, Patience, Kindness...",n.width/2-150,n.height/2+180),t.fillText("💡 Buy 'Extra Diagonal Bullets' in shop for additional 4-way fire!",n.width/2-150,n.height/2+200)}function et(){t.fillStyle="rgba(0, 0, 0, 0.8)",t.fillRect(0,0,n.width,n.height),t.fillStyle="white",t.font="40px Arial",t.fillText("GAME OVER",n.width/2-100,n.height/2-50),t.font="24px Arial",t.fillText(`Final Score: ${A}`,n.width/2-80,n.height/2),t.fillText("Click to restart",n.width/2-80,n.height/2+50)}function tt(){t.fillStyle="rgba(0, 0, 0, 0.8)",t.fillRect(0,0,n.width,n.height),t.fillStyle="white",t.font="36px Arial",t.fillText("🛒 SHOP",n.width/2-60,80),t.font="24px Arial",t.fillText(`💰 Coins: ${S}`,n.width/2-60,120);const e=160,o=60;ae.forEach((i,a)=>{const s=e+a*o,r=S>=i.cost;if(t.fillStyle=r?"rgba(255, 255, 255, 0.1)":"rgba(100, 100, 100, 0.3)",t.fillRect(n.width/2-150,s-10,300,50),t.strokeStyle=r?"white":"gray",t.lineWidth=2,t.strokeRect(n.width/2-150,s-10,300,50),t.fillStyle=r?"white":"gray",t.font="20px Arial",t.fillText(i.name,n.width/2-140,s+10),t.font="16px Arial",t.fillText(`Cost: ${i.cost} coins`,n.width/2-140,s+30),r){const d=window.hoveredButton&&window.hoveredButton.index===a;t.fillStyle=d?"lime":"green",t.fillRect(n.width/2+50,s-5,80,40),t.fillStyle="white",t.font="16px Arial",t.fillText("BUY",n.width/2+70,s+20),t.strokeStyle=d?"yellow":"lime",t.lineWidth=d?3:2,t.strokeRect(n.width/2+50,s-5,80,40)}}),t.fillStyle="white",t.font="16px Arial",t.fillText("Click on BUY to purchase items",n.width/2-100,n.height-60),t.fillText("Press SHOP button again to close",n.width/2-100,n.height-40)}function it(){t.fillStyle="rgba(0, 0, 0, 0.7)",t.fillRect(0,0,n.width,n.height),t.fillStyle="white",t.font="40px Arial",t.fillText("⏸ PAUSED",n.width/2-100,n.height/2-80),t.font="20px Arial",t.fillText(`Level: ${c} - ${U(c)}`,n.width/2-120,n.height/2-40),t.fillText(`Score: ${A} | Lives: ${I} | Coins: ${S}`,n.width/2-140,n.height/2-15),t.font="18px Arial",t.fillText("Press P or PAUSE button to resume",n.width/2-140,n.height/2+15),t.fillText("Press S or SHOP button to open shop",n.width/2-140,n.height/2+40);const e=n.height/2+80,o=200,i=50,a=n.width/2-o/2;t.fillStyle="#4CAF50",t.fillRect(a,e,o,i),t.strokeStyle="lime",t.lineWidth=3,t.strokeRect(a,e,o,i),t.fillStyle="white",t.font="18px Arial",t.textAlign="center",t.fillText("📤 Share Score",n.width/2,e+32),t.textAlign="left",t.fillStyle="#CCCCCC",t.font="14px Arial",t.textAlign="center",t.fillText("Share score with friends",n.width/2,e+55),t.textAlign="left"}function Se(){console.log("Share button clicked!"),console.log("Web Share API available:",!!navigator.share);const e=`🦖 DINO WARFARE SCORE CHALLENGE! 🦖

I scored ${A} points in DinoWarfare!
Level: ${c} - ${U(c)}
Theme: ${ne(c)}

Can you beat my score? 
Challenge accepted? 💪

#DinoWarfare #Gaming #Challenge`;if(navigator.share){console.log("Attempting to use Web Share API...");const o={title:"🦖 DinoWarfare Score Challenge",text:e,url:window.location.href};navigator.share(o).then(()=>{console.log("Score shared successfully via Web Share API"),ot("Score shared successfully!")}).catch(i=>{console.log("Web Share API failed:",i),le()})}else console.log("Web Share API not available, showing social share options..."),le()}function ot(e=null){alert(e?`Score shared successfully!

${e}

Share this with your friends!`:`🎉 Score copied to clipboard!

Share it with your friends and challenge them to beat your score!`)}function le(){console.log("Showing social share options dialog...");const e=`🦖 DINO WARFARE SCORE CHALLENGE! 🦖

I scored ${A} points in DinoWarfare!
Level: ${c} - ${U(c)}
Theme: ${ne(c)}

Can you beat my score? 
Challenge accepted? 💪

#DinoWarfare #Gaming #Challenge`,o=encodeURIComponent(window.location.href),i=encodeURIComponent(e),a={twitter:`https://twitter.com/intent/tweet?text=${i}&url=${o}`,facebook:`https://www.facebook.com/sharer/sharer.php?u=${o}`,whatsapp:`https://wa.me/?text=${i}%20${o}`,telegram:`https://t.me/share/url?url=${o}&text=${i}`,email:`mailto:?subject=DinoWarfare Score Challenge&body=${i}%0A%0A${o}`},s=document.createElement("div");s.style.cssText=`
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 10000;
    font-family: Arial, sans-serif;
  `;const r=document.createElement("div");r.style.cssText=`
    background: white;
    padding: 30px;
    border-radius: 15px;
    text-align: center;
    max-width: 400px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
  `,r.innerHTML=`
    <h2 style="color: #333; margin-bottom: 20px;">🦖 Share Your Score!</h2>
    <p style="color: #666; margin-bottom: 25px;">Choose how you want to share your amazing score:</p>
    
    <div style="display: grid; gap: 10px; margin-bottom: 20px;">
      <button onclick="window.open('${a.twitter}', '_blank')" style="background: #1DA1F2; color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer; font-size: 16px;">
        🐦 Share on Twitter
      </button>
      
      <button onclick="window.open('${a.facebook}', '_blank')" style="background: #4267B2; color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer; font-size: 16px;">
        📘 Share on Facebook
      </button>
      
      <button onclick="window.open('${a.whatsapp}', '_blank')" style="background: #25D366; color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer; font-size: 16px;">
        💬 Share on WhatsApp
      </button>
      
      <button onclick="window.open('${a.telegram}', '_blank')" style="background: #0088cc; color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer; font-size: 16px;">
        📱 Share on Telegram
      </button>
      
      <button onclick="window.open('${a.email}', '_blank')" style="background: #EA4335; color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer; font-size: 16px;">
        📧 Share via Email
      </button>
    </div>
    
    <button onclick="copyToClipboard('${e}')" style="background: #4CAF50; color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer; font-size: 16px; margin-right: 10px;">
      📋 Copy to Clipboard
    </button>
    
    <button onclick="this.parentElement.parentElement.remove()" style="background: #666; color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer; font-size: 16px;">
      ❌ Close
    </button>
  `,s.appendChild(r),document.body.appendChild(s),s.addEventListener("click",d=>{d.target===s&&s.remove()})}function xe(){Je(),Qe(),requestAnimationFrame(xe)}function nt(){t.fillStyle="#000000",t.fillRect(0,0,n.width,n.height),t.strokeStyle="#1a1a1a",t.lineWidth=1;for(let e=0;e<n.width;e+=50)t.beginPath(),t.moveTo(e,0),t.lineTo(e,n.height),t.stroke();for(let e=0;e<n.height;e+=50)t.beginPath(),t.moveTo(0,e),t.lineTo(n.width,e),t.stroke()}function at(){H.volume=.3,$.volume=.4,X.volume=.5,J.volume=.4,z.volume=.4,f.volume=.2,K.volume=.4,console.log("Sound system initialized")}window.addEventListener("load",()=>{nt(),at(),t.fillStyle="#000000",t.fillRect(0,0,n.width,n.height),console.log("DinoWarfare initialized successfully"),console.log("Canvas size:",n.width,"x",n.height),console.log("Sound files loaded:",{shoot:H.readyState,hit:$.readyState,bgMusic:f.readyState})});xe();const W={publishableKey:"pk_test_demo_key_here",secretKey:"sk_test_demo_key_here",webhookSecret:"whsec_demo_secret_here",subscriptionPrice:250,currency:"USD",gameName:"DinoWarfare"};class ve{constructor(){this.stripe=null,this.elements=null,this.cardElement=null,this.isInitialized=!1}async initialize(){try{if(console.log("Initializing Stripe with demo configuration..."),!window.Stripe)try{await this.loadStripeScript()}catch{return console.warn("Stripe.js not available, using demo mode"),this.isInitialized=!0,!0}return window.Stripe&&(this.stripe=Stripe(W.publishableKey)),this.isInitialized=!0,console.log("✅ Stripe initialized successfully (demo mode)"),!0}catch(o){return console.warn("❌ Stripe initialization failed, using demo mode:",o),this.isInitialized=!0,!0}}loadStripeScript(){return new Promise((o,i)=>{if(window.Stripe){o();return}const a=document.createElement("script");a.src="https://js.stripe.com/v3/",a.onload=()=>o(),a.onerror=()=>i(new Error("Failed to load Stripe.js")),document.head.appendChild(a)})}createPaymentElements(){if(!this.isInitialized)return console.error("Stripe not initialized"),!1;try{this.elements=this.stripe.elements(),this.cardElement=this.elements.create("card",{style:{base:{fontSize:"16px",color:"#ffffff","::placeholder":{color:"#aab7c4"}},invalid:{color:"#fa755a",iconColor:"#fa755a"}}});const o=document.getElementById("card-element");return o?(this.cardElement.mount(o),console.log("✅ Payment elements created"),!0):(console.error("Card element container not found"),!1)}catch(o){return console.error("❌ Failed to create payment elements:",o),!1}}async processPayment(o=W.subscriptionPrice){if(console.log("Processing payment for amount:",o),!this.isInitialized)return console.error("Stripe not properly initialized"),{success:!1,error:"Payment system not ready"};try{if(this.stripe&&this.cardElement){const{paymentMethod:i,error:a}=await this.stripe.createPaymentMethod({type:"card",card:this.cardElement,billing_details:{name:"DinoWarfare Premium Subscription"}});return a?(console.error("Payment method error:",a),{success:!1,error:a.message}):(console.log("Payment method created:",i.id),await this.simulateServerPayment(i.id,o))}else return console.log("Running in demo mode - simulating payment"),await this.simulateServerPayment("demo_payment_method",o)}catch(i){return console.error("Payment processing error:",i),{success:!1,error:"Payment processing failed"}}}async simulateServerPayment(o,i){return new Promise(a=>{setTimeout(()=>{const s=Math.random()>.05;a(s?{success:!0,transactionId:"txn_"+Math.random().toString(36).substr(2,9),amount:i,currency:W.currency}:{success:!1,error:"Payment declined by bank"})},2e3)})}handlePaymentError(o){const i=document.getElementById("card-errors");i&&(i.textContent=o,i.style.display="block"),console.error("Payment error:",o)}clearPaymentErrors(){const o=document.getElementById("card-errors");o&&(o.textContent="",o.style.display="none")}getSubscriptionPrice(){return(W.subscriptionPrice/100).toFixed(2)}formatCurrency(o){return new Intl.NumberFormat("en-US",{style:"currency",currency:W.currency}).format(o/100)}}window.stripePaymentProcessor=new ve;document.addEventListener("DOMContentLoaded",async()=>{console.log("Stripe config loading...");try{const e=await window.stripePaymentProcessor.initialize();if(console.log("Stripe initialization result:",e),document.getElementById("payment-form")&&e){const i=window.stripePaymentProcessor.createPaymentElements();console.log("Stripe elements created:",i)}}catch(e){console.warn("Stripe initialization failed:",e)}});typeof V<"u"&&V.exports&&(V.exports={StripePaymentProcessor:ve,STRIPE_CONFIG:W})});export default lt();
